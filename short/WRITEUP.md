# Ultimate shortening: Write-up

Заходим на сайт, видим сокращатель ссылок. Если обратить внимание, то становится заметно, что 
сервис проверяет существование сайта, который сокращается, с помощью браузера IE6 (на самом деле, 
с помощью библиотеки `requests` для Python, но с измененным `User-Agent`).

Но таск намного проще: заметим, что в описании было что-то про утечку данных и аналитику. А в 
самом сокращателе было упоминание, что клиент сервиса — наша CTF-команда. Значит, мы сокращали 
ссылки. Но как же можно посмотреть сокращенные ссылки? Заметим, что при переходе мы натыкаемся 
на промежуточную страницу с текстом «сейчас вы будете направлены на сайт», а на этой странице 
(кроме надписи) есть счетчик Яндекс.Метрики.

Так как `sqlmap` не показывает никаких признаков инъекции ни в URL, ни в поле для сокращения 
ссылки, Метрика остается единственным возможным источником утечки (более того, её наличие очень 
подозрительно, так как мы не собираем статистику ни на платформе, ни на одном из тасков).

Из кода страницы узнаем ID счетчика, дальше пробуем сами завести себе один, и узнаем, какая была 
бы ссылка. Ссылки выглядят так: `https://metrika.yandex.ru/dashboard?id=XXX`. Подставляем ID, 
заходим на Метрику. Что дальше? Мутный перебор всех ссылок?

Нет, поступим проще. Просто посмотрим визиты до 30 июня (например, с 27 по 29). Так как там нет 
участников CTF, ссылок там немного. Переберем все, и найдем ту, что ведет к флагу. Флаг лежал [вот тут](https://ctf.upml.tech/secret_flag_124EHx.html)

Флаг: **uctf_pl3as3_d0nt_f0110w_me**
